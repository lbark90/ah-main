(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[204],{8799:function(e,t,r){Promise.resolve().then(r.bind(r,8242))},8242:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var s=r(7437),l=r(7648),a=r(9501),o=r(3590),i=r(1229),n=r(9376),c=r(2084),d=r(2265);let m=i.Ry({username:i.Z_().min(3,"Username must be at least 3 characters").regex(/^[a-zA-Z0-9_]+$/,"Username can only contain letters, numbers and underscores"),firstName:i.Z_().min(1,"First name is required"),middleName:i.Z_().optional(),lastName:i.Z_().min(1,"Last name is required"),dateOfBirth:i.Z_().min(1,"Date of birth is required"),email:i.Z_().email("Please enter a valid email address"),phone:i.Z_().min(10,"Please enter a valid phone number"),password:i.Z_().min(8,"Password must be at least 8 characters"),confirmPassword:i.Z_()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function u(){let[e,t]=(0,d.useState)(!1),[r,l]=(0,d.useState)(""),[i,u]=(0,d.useState)(!1),f=(0,n.useRouter)(),{setUser:b}=(0,c.a)(),{register:x,handleSubmit:h,formState:{errors:g}}=(0,a.cI)({resolver:(0,o.F)(m)}),p=async e=>{l(""),u(!0);try{console.log("Submitting registration data:",e);let t={...e,userId:e.username,phoneNumber:e.phone,password:e.password,created_at:new Date().toISOString(),last_modified:new Date().toISOString()};console.log("Registering user with username: ".concat(e.username));let r=await fetch("/api/storage/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:t})});console.log("GCS response status:",r.status);let s=await r.json();if(console.log("GCS response data:",s),!r.ok)throw Error(s.message||"Registration failed: Server returned ".concat(r.status));b({id:e.username,username:e.username,firstName:e.firstName,middleName:e.middleName,lastName:e.lastName,email:e.email,phone:e.phone,dob:e.dateOfBirth}),f.push("/interview")}catch(e){console.error("Registration error details:",e),l(e.message||"An unexpected error occurred during registration")}finally{u(!1)}};return(0,s.jsxs)("form",{onSubmit:h(p),className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-slate-300 mb-1",children:"Username"}),(0,s.jsx)("input",{type:"text",id:"username",style:{backgroundColor:"#141c2f",color:"#e2e8f0"},className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 [&:-webkit-autofill]:bg-[#141c2f] [&:-webkit-autofill]:text-[#e2e8f0] [&:-webkit-autofill_selected]:bg-[#141c2f] [&:-webkit-autofill]:!fill-[#e2e8f0] ".concat(g.username?"border-red-500":"border-slate-600"),placeholder:"Choose a unique username",...x("username")}),g.username&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:g.username.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-slate-300 mb-1",children:"First Name"}),(0,s.jsx)("input",{type:"text",id:"firstName",style:{backgroundColor:"#141c2f",color:"#e2e8f0"},className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 [&:-webkit-autofill]:bg-[#141c2f] [&:-webkit-autofill]:text-[#e2e8f0] [&:-webkit-autofill_selected]:bg-[#141c2f] [&:-webkit-autofill]:!fill-[#e2e8f0] ".concat(g.firstName?"border-red-500":"border-slate-600"),placeholder:"Enter your first name",...x("firstName")}),g.firstName&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:g.firstName.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"middleName",className:"block text-sm font-medium text-slate-300 mb-1",children:"Middle Name"}),(0,s.jsx)("input",{type:"text",id:"middleName",style:{backgroundColor:"#141c2f",color:"#e2e8f0"},className:"w-full px-4 py-2 border border-slate-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 [&:-webkit-autofill]:bg-[#141c2f] [&:-webkit-autofill]:text-[#e2e8f0] [&:-webkit-autofill_selected]:bg-[#141c2f] [&:-webkit-autofill]:!fill-[#e2e8f0]",placeholder:"Enter your middle name (optional)",...x("middleName")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-slate-300 mb-1",children:"Last Name"}),(0,s.jsx)("input",{type:"text",id:"lastName",style:{backgroundColor:"#141c2f",color:"#e2e8f0"},className:"w-full px-4 py-2 bg-[#141c2f] border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 [&:-webkit-autofill]:bg-[#141c2f] [&:-webkit-autofill]:text-[#e2e8f0] [&:-webkit-autofill_selected]:bg-[#141c2f] [&:-webkit-autofill]:!fill-[#e2e8f0] ".concat(g.lastName?"border-red-500":"border-slate-600"),placeholder:"Enter your last name",...x("lastName")}),g.lastName&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:g.lastName.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-300 mb-1",children:"Email Address"}),(0,s.jsx)("input",{type:"email",id:"email",style:{backgroundColor:"#141c2f",color:"#e2e8f0"},className:"w-full px-4 py-2 bg-[#141c2f] border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 [&:-webkit-autofill]:bg-[#141c2f] [&:-webkit-autofill]:text-[#e2e8f0] [&:-webkit-autofill_selected]:bg-[#141c2f] [&:-webkit-autofill]:!fill-[#e2e8f0] ".concat(g.email?"border-red-500":"border-slate-600"),placeholder:"Enter your email address",...x("email")}),g.email&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:g.email.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"dateOfBirth",className:"block text-sm font-medium text-slate-300 mb-1",children:"Date of Birth"}),(0,s.jsx)("input",{type:"date",id:"dateOfBirth",style:{backgroundColor:"#141c2f",color:"#e2e8f0"},className:"w-full px-4 py-2 bg-[#141c2f] border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 [&:-webkit-autofill]:bg-[#141c2f] [&:-webkit-autofill]:text-[#e2e8f0] [&:-webkit-autofill_selected]:bg-[#141c2f] [&:-webkit-autofill]:!fill-[#e2e8f0] ".concat(g.dateOfBirth?"border-red-500":"border-slate-600"),...x("dateOfBirth")}),g.dateOfBirth&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:g.dateOfBirth.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-slate-300 mb-1",children:"Phone Number"}),(0,s.jsx)("input",{type:"tel",id:"phone",style:{backgroundColor:"#141c2f",color:"#e2e8f0"},className:"w-full px-4 py-2 bg-[#141c2f] border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 [&:-webkit-autofill]:bg-[#141c2f] [&:-webkit-autofill]:text-[#e2e8f0] [&:-webkit-autofill_selected]:bg-[#141c2f] [&:-webkit-autofill]:!fill-[#e2e8f0] ".concat(g.phone?"border-red-500":"border-slate-600"),placeholder:"Enter your phone number",...x("phone")}),g.phone&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:g.phone.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-300 mb-1",children:"Password"}),(0,s.jsx)("input",{type:"password",id:"password",style:{backgroundColor:"#141c2f",color:"#e2e8f0"},className:"w-full px-4 py-2 bg-[#141c2f] border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 [&:-webkit-autofill]:bg-[#141c2f] [&:-webkit-autofill]:text-[#e2e8f0] [&:-webkit-autofill_selected]:bg-[#141c2f] [&:-webkit-autofill]:!fill-[#e2e8f0] ".concat(g.password?"border-red-500":"border-slate-600"),placeholder:"Enter your password",...x("password")}),g.password&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:g.password.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-slate-300 mb-1",children:"Confirm Password"}),(0,s.jsx)("input",{type:"password",id:"confirmPassword",style:{backgroundColor:"#141c2f",color:"#e2e8f0"},className:"w-full px-4 py-2 bg-[#141c2f] border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 [&:-webkit-autofill]:bg-[#141c2f] [&:-webkit-autofill]:text-[#e2e8f0] [&:-webkit-autofill_selected]:bg-[#141c2f] [&:-webkit-autofill]:!fill-[#e2e8f0] ".concat(g.confirmPassword?"border-red-500":"border-slate-600"),placeholder:"Confirm your password",...x("confirmPassword")}),g.confirmPassword&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:g.confirmPassword.message})]})]}),r&&(0,s.jsx)("div",{className:"p-3 bg-red-900/30 border border-red-800 rounded text-red-300 text-sm",children:r}),(0,s.jsx)("div",{className:"pt-4",children:(0,s.jsx)("button",{type:"submit",disabled:i,className:"w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-md transition-colors flex items-center justify-center ".concat(i?"opacity-70 cursor-not-allowed":""),children:i?"Creating Account...":"Start Now"})}),(0,s.jsx)("p",{className:"text-sm text-slate-400 text-center mt-6",children:"By continuing, you agree to our Terms of Service and Privacy Policy."})]},"registration-form")}function f(){return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-slate-900 to-slate-800 text-white",children:[(0,s.jsx)("header",{className:"container mx-auto px-4 py-8",children:(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsxs)(l.default,{href:"/",className:"text-3xl font-light",children:["AliveHere",(0,s.jsx)("span",{className:"text-blue-400",children:".com"})]})})}),(0,s.jsx)("main",{className:"container mx-auto px-4 py-12",children:(0,s.jsxs)("div",{className:"max-w-md mx-auto bg-slate-800/50 p-8 rounded-lg border border-slate-700",children:[(0,s.jsx)("h1",{className:"text-3xl font-light mb-6 text-center",children:"Begin Your Legacy"}),(0,s.jsx)("p",{className:"text-slate-300 mb-8 text-center",children:"Enter your information below to start preserving your voice and story for future generations."}),(0,s.jsx)(u,{})]})}),(0,s.jsx)("footer",{className:"bg-slate-950 py-6 mt-auto",children:(0,s.jsx)("div",{className:"container mx-auto px-4 text-center text-slate-500",children:(0,s.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," AliveHere. All rights reserved."]})})})]})}},2084:function(e,t,r){"use strict";r.d(t,{a:function(){return i},d:function(){return o}});var s=r(7437),l=r(2265);let a=(0,l.createContext)(void 0),o=e=>{let{children:t}=e,[r,o]=(0,l.useState)(null),[i,n]=(0,l.useState)(!0);(0,l.useEffect)(()=>{(()=>{try{let e=document.cookie.split("; ").find(e=>e.startsWith("userId="));if(e){let t=e.split("=")[1];console.log("Found user cookie with ID:",t),fetch("/api/user/login_credentials?userId=".concat(t)).then(e=>e.json()).then(e=>{if(!e.error){let t={id:e.userId,username:e.userId,firstName:e.firstName,middleName:e.middleName||"",lastName:e.lastName,email:e.email,phone:e.phoneNumber,dob:e.dateOfBirth};o(t),localStorage.setItem("aliveHereUser",JSON.stringify(t))}n(!1)}).catch(()=>{n(!1)});return}let t=localStorage.getItem("aliveHereUser");t&&(console.log("Loading user from localStorage"),o(JSON.parse(t)))}catch(e){console.error("Error loading user from storage:",e)}finally{n(!1)}})()},[]);let c=e=>{console.log("Setting user with ID:",null==e?void 0:e.id),e&&!e.id&&console.error("User object is missing ID field"),o(e),e?localStorage.setItem("aliveHereUser",JSON.stringify(e)):localStorage.removeItem("aliveHereUser")},d=async()=>{try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){console.error("Error during logout:",e)}finally{c(null),document.cookie="userId=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"}},m=async e=>{try{c(e)}catch(e){throw console.error("Error registering user:",e),e}};return(0,s.jsx)(a.Provider,{value:{user:r,setUser:c,logout:d,isLoading:i,registerUser:m},children:t})},i=()=>{let e=(0,l.useContext)(a);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}}},function(e){e.O(0,[972,514,971,117,744],function(){return e(e.s=8799)}),_N_E=e.O()}]);