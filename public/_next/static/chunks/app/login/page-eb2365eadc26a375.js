(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{9471:function(e,t,r){Promise.resolve().then(r.bind(r,6374))},6374:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var s=r(7437),o=r(2265),a=r(9376),n=r(7648),l=r(2084);function i(){let[e,t]=(0,o.useState)(""),[r,i]=(0,o.useState)(""),[c,u]=(0,o.useState)(!1),[d,m]=(0,o.useState)(""),[h,x]=(0,o.useState)(!1),f=(0,a.useRouter)(),{setUser:g}=(0,l.a)(),p=async t=>{t.preventDefault(),m(""),x(!0);try{console.log("Attempting to login with username: ".concat(e));let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})}),s=await t.json();if(t.ok){console.log("Login successful:",s);let t=s.user.userId||s.user.id;g({id:t,firstName:s.user.firstName||"",lastName:s.user.lastName||"",email:s.user.email||e}),setTimeout(()=>{f.push("/profile")},100)}else console.error("Login failed:",s),m(s.error||"Invalid username or password")}catch(e){console.error("Login error:",e),m("An error occurred during login. Please try again.")}finally{x(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-slate-900 to-slate-800 text-white flex flex-col",children:[(0,s.jsx)("header",{className:"container mx-auto px-4 py-8",children:(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsxs)(n.default,{href:"/",className:"text-3xl font-light",children:["AliveHere",(0,s.jsx)("span",{className:"text-blue-400",children:".com"})]})})}),(0,s.jsx)("main",{className:"container mx-auto px-4 py-6 flex-grow",children:(0,s.jsxs)("div",{className:"max-w-md mx-auto bg-slate-800/50 p-8 rounded-lg border border-slate-700",children:[(0,s.jsx)("h1",{className:"text-3xl font-light mb-6 text-center",children:"Welcome Back"}),(0,s.jsx)("p",{className:"text-slate-300 mb-8 text-center",children:"Sign in to continue your legacy journey."}),(0,s.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-slate-300 mb-1",children:"Username"}),(0,s.jsx)("input",{type:"text",id:"username",value:e,onChange:e=>t(e.target.value),className:"w-full px-4 py-2 bg-slate-900/50 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 border-slate-600",placeholder:"Enter your username",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-300 mb-1",children:"Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:c?"text":"password",id:"password",value:r,onChange:e=>i(e.target.value),className:"w-full px-4 py-2 bg-slate-900/50 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 border-slate-600",placeholder:"Enter your password",required:!0}),(0,s.jsx)("button",{type:"button",onClick:()=>u(!c),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:c?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-slate-400",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"})}):(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-slate-400",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]})})]})]}),d&&(0,s.jsx)("div",{className:"bg-red-500/10 border border-red-500/50 rounded p-3",children:(0,s.jsx)("p",{className:"text-red-400 text-sm",children:d})}),(0,s.jsx)("button",{type:"submit",disabled:h,className:"w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-md transition-colors disabled:opacity-50 flex items-center justify-center",children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing In..."]}):"Sign In"}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("button",{type:"button",onClick:()=>{alert("Please contact support to reset your password.")},className:"text-blue-400 hover:text-blue-300 text-sm",children:"Forgot your password?"})})]}),(0,s.jsxs)("p",{className:"text-center mt-6 text-slate-400",children:["Don't have an account?"," ",(0,s.jsx)(n.default,{href:"/registration",className:"text-blue-400 hover:text-blue-300",children:"Register here"})]})]})}),(0,s.jsx)("footer",{className:"bg-slate-950 py-6 w-full mt-auto",children:(0,s.jsx)("div",{className:"container mx-auto px-4 text-center text-slate-500",children:(0,s.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," AliveHere. All rights reserved."]})})})]})}},2084:function(e,t,r){"use strict";r.d(t,{a:function(){return l},d:function(){return n}});var s=r(7437),o=r(2265);let a=(0,o.createContext)(void 0),n=e=>{let{children:t}=e,[r,n]=(0,o.useState)(null),[l,i]=(0,o.useState)(!0);(0,o.useEffect)(()=>{(()=>{try{let e=document.cookie.split("; ").find(e=>e.startsWith("userId="));if(e){let t=e.split("=")[1];console.log("Found user cookie with ID:",t),fetch("/api/user/login_credentials?userId=".concat(t)).then(e=>e.json()).then(e=>{if(!e.error){let t={id:e.userId,username:e.userId,firstName:e.firstName,middleName:e.middleName||"",lastName:e.lastName,email:e.email,phone:e.phoneNumber,dob:e.dateOfBirth};n(t),localStorage.setItem("aliveHereUser",JSON.stringify(t))}i(!1)}).catch(()=>{i(!1)});return}let t=localStorage.getItem("aliveHereUser");t&&(console.log("Loading user from localStorage"),n(JSON.parse(t)))}catch(e){console.error("Error loading user from storage:",e)}finally{i(!1)}})()},[]);let c=e=>{console.log("Setting user with ID:",null==e?void 0:e.id),e&&!e.id&&console.error("User object is missing ID field"),n(e),e?localStorage.setItem("aliveHereUser",JSON.stringify(e)):localStorage.removeItem("aliveHereUser")},u=async()=>{try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){console.error("Error during logout:",e)}finally{c(null),document.cookie="userId=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"}},d=async e=>{try{c(e)}catch(e){throw console.error("Error registering user:",e),e}};return(0,s.jsx)(a.Provider,{value:{user:r,setUser:c,logout:u,isLoading:l,registerUser:d},children:t})},l=()=>{let e=(0,o.useContext)(a);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return o.a}});var s=r(2972),o=r.n(s)},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=9471)}),_N_E=e.O()}]);