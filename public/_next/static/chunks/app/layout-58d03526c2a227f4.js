(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1074:function(e,t,r){Promise.resolve().then(r.bind(r,3521)),Promise.resolve().then(r.t.bind(r,7960,23)),Promise.resolve().then(r.bind(r,9294)),Promise.resolve().then(r.bind(r,953)),Promise.resolve().then(r.t.bind(r,4742,23))},3521:function(e,t,r){"use strict";r.d(t,{default:function(){return i}});var o=r(7437),n=r(7648),s=r(9376);function i(){let e=(0,s.usePathname)(),t="/"===e,r="/login"===e;return t||r||"/registration"===e?null:(0,o.jsx)("header",{className:"bg-slate-900 text-white",children:(0,o.jsxs)("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[(0,o.jsxs)(n.default,{href:"/",className:"text-xl font-light",children:["AliveHere",(0,o.jsx)("span",{className:"text-blue-400",children:".com"})]}),!t&&!r&&(0,o.jsx)("div",{className:"flex items-center gap-6",children:(0,o.jsx)("nav",{children:(0,o.jsxs)("ul",{className:"flex items-center gap-6",children:[(0,o.jsx)("li",{children:(0,o.jsx)(n.default,{href:"/interview",className:"text-sm hover:text-blue-400 transition-colors",children:"Interview"})}),(0,o.jsx)("li",{children:(0,o.jsx)(n.default,{href:"/profile",className:"text-sm hover:text-blue-400 transition-colors",children:"Profile"})}),(0,o.jsx)("li",{children:(0,o.jsx)(n.default,{href:"/conversation",className:"text-sm hover:text-blue-400 transition-colors",children:"Conversation"})})]})})})]})})}},9294:function(e,t,r){"use strict";r.d(t,{default:function(){return c}});var o=r(7437),n=r(2084),s=r(724),i=r(9976),a=r(536);function c(e){let{children:t}=e;return(0,o.jsx)(n.d,{children:(0,o.jsx)(s.E,{children:(0,o.jsx)(a.c,{children:(0,o.jsx)(i.$,{children:t})})})})}},953:function(e,t,r){"use strict";var o=r(7437),n=r(2265);class s extends n.Component{static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("ChunkErrorBoundary caught an error:",e,t),e.message&&e.message.includes("Loading chunk")&&(console.log("Chunk loading error detected, refreshing the page..."),setTimeout(()=>{window.location.reload()},2e3))}render(){return this.state.hasError?this.props.fallback||(0,o.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md m-4",children:[(0,o.jsx)("h2",{className:"text-red-600 text-lg font-medium mb-2",children:"Something went wrong loading the application"}),(0,o.jsx)("p",{className:"text-red-500 mb-4",children:"The application is recovering..."}),(0,o.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md",children:"Reload Now"})]}):this.props.children}constructor(e){super(e),this.state={hasError:!1}}}t.default=s},9976:function(e,t,r){"use strict";r.d(t,{$:function(){return a},P:function(){return i}});var o=r(7437),n=r(2265);let s=(0,n.createContext)({assistant:null,conversation:null,isLoading:!0,isProcessing:!1,createAssistant:async()=>({assistantId:"",name:"",status:"",createdAt:"",userId:""}),startConversation:async()=>({conversationId:"",messages:[]}),sendMessage:async()=>{}}),i=()=>(0,n.useContext)(s);function a(e){let{children:t}=e,[r,i]=(0,n.useState)(null),[a,c]=(0,n.useState)(null),[l,d]=(0,n.useState)(!0),[u,g]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(()=>{try{let e=localStorage.getItem("aliveHereAssistant");e&&i(JSON.parse(e));let t=localStorage.getItem("aliveHereConversation");t&&c(JSON.parse(t))}catch(e){console.error("Error loading assistant data:",e)}finally{d(!1)}})()},[]);let h=async e=>{try{g(!0);let t={assistantId:"assistant_".concat(Date.now()),name:e,status:"active",createdAt:new Date().toISOString(),userId:"user_".concat(Date.now())};return localStorage.setItem("aliveHereAssistant",JSON.stringify(t)),i(t),t}catch(e){throw console.error("Error creating assistant:",e),e}finally{g(!1)}},f=async e=>{try{g(!0);let t=r;t||(t=await h("AI Assistant"));let o={conversationId:"conv_".concat(Date.now()),messages:[{role:"user",content:e,timestamp:new Date().toISOString()}]};return localStorage.setItem("aliveHereConversation",JSON.stringify(o)),c(o),o}catch(e){throw console.error("Error starting conversation:",e),e}finally{g(!1)}},v=async e=>{try{if(g(!0),!r||!a)throw Error("No active conversation");let t=[...a.messages,{role:"user",content:e,timestamp:new Date().toISOString()}],o={...a,messages:t};localStorage.setItem("aliveHereConversation",JSON.stringify(o)),c(o)}catch(e){throw console.error("Error sending message:",e),e}finally{g(!1)}};return(0,o.jsx)(s.Provider,{value:{assistant:r,conversation:a,isLoading:l,isProcessing:u,createAssistant:h,startConversation:f,sendMessage:v},children:t})}},536:function(e,t,r){"use strict";r.d(t,{c:function(){return a},z:function(){return c}});var o=r(7437),n=r(2265),s=r(9239);let i=(0,n.createContext)({currentSession:null,startNewSession:()=>{},addRecording:()=>{},replaceRecording:()=>{},getCurrentQuestionRecording:()=>void 0,goToNextQuestion:()=>{},goToPreviousQuestion:()=>!1,completeSession:async()=>{}});function a(e){let{children:t}=e,[r,a]=(0,n.useState)(null),c=async()=>{r&&a({...r,completedAt:new Date().toISOString()})};return(0,o.jsx)(i.Provider,{value:{currentSession:r,startNewSession:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.length>0?Math.max(...e.map(e=>e.questionIndex))+1:0;a({id:"session_".concat(Date.now()),questionIndex:t,recordings:Array.isArray(e)?e:[]})},addRecording:e=>{if(r)try{s.D.saveRecording(e);let t=[...r.recordings];t.push(e);let o={...r,recordings:t};a(o)}catch(e){throw console.error("Failed to save recording:",e),e}},replaceRecording:e=>{if(r)try{let t=r.recordings.findIndex(t=>t.questionIndex===e.questionIndex);if(-1!==t){s.D.replaceRecording(t,e);let o=[...r.recordings];o[t]=e;let n={...r,recordings:o};a(n)}}catch(e){throw console.error("Failed to replace recording:",e),e}},getCurrentQuestionRecording:()=>{if(r)return r.recordings.find(e=>e.questionIndex===r.questionIndex)},goToNextQuestion:()=>{r&&a({...r,questionIndex:r.questionIndex+1})},goToPreviousQuestion:()=>!!r&&0!==r.questionIndex&&(a({...r,questionIndex:r.questionIndex-1}),!0),completeSession:c},children:t})}let c=()=>(0,n.useContext)(i)},2084:function(e,t,r){"use strict";r.d(t,{a:function(){return a},d:function(){return i}});var o=r(7437),n=r(2265);let s=(0,n.createContext)(void 0),i=e=>{let{children:t}=e,[r,i]=(0,n.useState)(null),[a,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(()=>{try{let e=document.cookie.split("; ").find(e=>e.startsWith("userId="));if(e){let t=e.split("=")[1];console.log("Found user cookie with ID:",t),fetch("/api/user/login_credentials?userId=".concat(t)).then(e=>e.json()).then(e=>{if(!e.error){let t={id:e.userId,username:e.userId,firstName:e.firstName,middleName:e.middleName||"",lastName:e.lastName,email:e.email,phone:e.phoneNumber,dob:e.dateOfBirth};i(t),localStorage.setItem("aliveHereUser",JSON.stringify(t))}c(!1)}).catch(()=>{c(!1)});return}let t=localStorage.getItem("aliveHereUser");t&&(console.log("Loading user from localStorage"),i(JSON.parse(t)))}catch(e){console.error("Error loading user from storage:",e)}finally{c(!1)}})()},[]);let l=e=>{console.log("Setting user with ID:",null==e?void 0:e.id),e&&!e.id&&console.error("User object is missing ID field"),i(e),e?localStorage.setItem("aliveHereUser",JSON.stringify(e)):localStorage.removeItem("aliveHereUser")},d=async()=>{try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){console.error("Error during logout:",e)}finally{l(null),document.cookie="userId=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"}},u=async e=>{try{l(e)}catch(e){throw console.error("Error registering user:",e),e}};return(0,o.jsx)(s.Provider,{value:{user:r,setUser:l,logout:d,isLoading:a,registerUser:u},children:t})},a=()=>{let e=(0,n.useContext)(s);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}},724:function(e,t,r){"use strict";r.d(t,{E:function(){return a},M:function(){return i}});var o=r(7437),n=r(2265);let s=(0,n.createContext)({voice:null,setVoice:()=>{}}),i=()=>(0,n.useContext)(s);function a(e){let{children:t}=e,[r,i]=(0,n.useState)(null),[a,c]=(0,n.useState)(null),l={voiceId:"fallback",name:"Fallback Voice",status:"fallback",createdAt:new Date().toISOString(),userId:"",isElevenLabsVoice:!1};(0,n.useEffect)(()=>{if("/login"!==window.location.pathname&&"/registration"!==window.location.pathname)try{let e=localStorage.getItem("aliveHereVoice"),t=localStorage.getItem("userId");if(!t){console.log("Skipping voice initialization - no user logged in");return}if(console.log("VoiceProvider initializing, userId:",t),e){let r=JSON.parse(e);r&&r.voiceId?(console.log("Loading voice from storage:",r),i(r),t&&(console.log("Validating voice with API call"),d(t))):(console.log("Invalid voice data structure in localStorage"),t&&d(t))}else console.log("No voice data found in localStorage"),t&&d(t)}catch(e){console.error("Voice data initialization error:",e),c(e instanceof Error?e.message:"Unknown error"),i(l)}},[]);let d=async e=>{if(!e){console.error("Cannot check voice API: No user ID provided");return}try{console.log("Checking voice API for user:",e),c(null);let t=new Date().getTime(),r=await fetch("/api/voice/check?userId=".concat(e,"&t=").concat(t),{cache:"no-store",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}});if(console.log("Voice API response status:",r.status),r.ok){let t=await r.json();if(console.log("Voice API returned data:",t),t.exists){console.log("Voice exists, creating voice data object");let r={voiceId:t.voiceId,name:t.name||"My Voice",status:t.status||"ready",createdAt:new Date().toISOString(),userId:e,isElevenLabsVoice:t.isElevenLabsVoice};if(console.log("Saving voice data to localStorage:",r),localStorage.setItem("aliveHereVoice",JSON.stringify(r)),i(r),t.isElevenLabsVoice&&t.voiceId)try{console.log("Fetching ElevenLabs voice details");let e=await fetch("/api/voice/fetch-from-elevenlabs?voiceId=".concat(t.voiceId));if(e.ok){let t=await e.json();console.log("ElevenLabs data:",t);let o={...r,elevenLabsData:t.voiceData};localStorage.setItem("aliveHereVoice",JSON.stringify(o)),i(o)}}catch(e){console.error("Error fetching ElevenLabs data:",e)}}else console.log("Voice API says voice does not exist"),i(l)}else{let e=await r.text();console.error("Voice check API error:",e),c("API error: ".concat(r.status," - ").concat(e)),i(l),localStorage.setItem("aliveHereVoice",JSON.stringify(l))}}catch(e){console.error("Error checking voice API:",e),c(e instanceof Error?e.message:"Unknown API error"),i(l)}};return(0,o.jsx)(s.Provider,{value:{voice:r,setVoice:i},children:t})}},9239:function(e,t,r){"use strict";r.d(t,{D:function(){return n}});class o{async saveRecording(e){try{this.recordings.push(e)}catch(e){throw console.error("Error saving recording:",e),Error((null==e?void 0:e.message)||"Failed to save recording")}}getSessionRecordings(){try{return this.recordings}catch(e){return console.error("Error getting recordings:",e),[]}}replaceRecording(e,t){try{this.recordings[e]=t}catch(e){throw console.error("Error replacing recording:",e),Error((null==e?void 0:e.message)||"Failed to replace recording")}}constructor(){this.recordings=[],this.RECORDINGS_KEY="recordings"}}let n=new o},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return n.a}});var o=r(2972),n=r.n(o)},9376:function(e,t,r){"use strict";var o=r(5475);r.o(o,"usePathname")&&r.d(t,{usePathname:function(){return o.usePathname}}),r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}})},7960:function(){},4742:function(e){e.exports={style:{fontFamily:"'__Inter_d65c78', '__Inter_Fallback_d65c78'",fontStyle:"normal"},className:"__className_d65c78"}}},function(e){e.O(0,[540,972,971,117,744],function(){return e(e.s=1074)}),_N_E=e.O()}]);