(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[745],{6064:function(e,t,n){Promise.resolve().then(n.bind(n,9604))},9604:function(e,t,n){"use strict";n.d(t,{default:function(){return o}});var c=n(7437),s=n(2265);function o(){let[e,t]=(0,s.useState)("Checking WebSocket status..."),[n,o]=(0,s.useState)(!1),[r,a]=(0,s.useState)([]),[d,l]=(0,s.useState)(""),i=(0,s.useRef)(null);(0,s.useEffect)(()=>(fetch("/api/socket/status").then(e=>e.json()).then(e=>{t("WebSocket server: ".concat(e.status," - ").concat(e.message)),"running"===e.status&&u()}).catch(e=>{t("Error checking WebSocket status: ".concat(e.message))}),()=>{i.current&&i.current.close()}),[]);let u=()=>{try{let e="https:"===window.location.protocol?"wss:":"ws:",n=window.location.hostname,c="".concat(e,"//").concat(n).concat(":8080");t("Attempting to connect to ".concat(c,"...")),i.current&&i.current.close();let s=new WebSocket(c);s.onopen=()=>{t("Connected to WebSocket server"),o(!0),b("System: Connected to WebSocket server");let e=JSON.stringify({type:"auth",user_id:"test_user",timestamp:Date.now()});console.log("Sending auth message:",e),s.send(e)},s.onmessage=e=>{try{let t=JSON.parse(e.data);"auth_success"===t.type?b("System: Authentication successful"):"ai_message"===t.type?b("AI: ".concat(t.message)):b("Received: ".concat(e.data))}catch(t){b("Received: ".concat(e.data))}},s.onerror=e=>{t("WebSocket error occurred"),b("Error: WebSocket connection error"),o(!1)},s.onclose=e=>{t("WebSocket connection closed: ".concat(e.code," ").concat(e.reason)),b("System: Connection closed (".concat(e.code,")")),o(!1)},i.current=s}catch(e){t("Failed to create WebSocket: ".concat(e instanceof Error?e.message:String(e)))}},b=e=>{a(t=>[...t,e])},g=()=>{if(!i.current||i.current.readyState!==WebSocket.OPEN){b("Error: WebSocket not connected");return}if(d.trim())try{i.current.send(JSON.stringify({type:"user_message",message:d,timestamp:Date.now()})),b("You: ".concat(d)),l("")}catch(e){b("Error sending message: ".concat(e.message))}};return(0,c.jsxs)("div",{className:"p-4 bg-slate-800 rounded-lg max-w-xl mx-auto my-8",children:[(0,c.jsx)("h2",{className:"text-xl font-bold mb-4",children:"WebSocket Test"}),(0,c.jsx)("div",{className:"p-2 mb-4 rounded ".concat(e.includes("running")||e.includes("Connected")?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"),children:e}),(0,c.jsx)("div",{className:"border border-slate-700 rounded-lg p-4 mb-4 h-64 overflow-y-auto bg-slate-900/50",children:r.map((e,t)=>(0,c.jsx)("div",{className:"mb-2",children:e},t))}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)("input",{type:"text",value:d,onChange:e=>l(e.target.value),onKeyPress:e=>"Enter"===e.key&&g(),disabled:!n,placeholder:"Type a message...",className:"flex-1 p-2 bg-slate-700 rounded border border-slate-600 focus:outline-none focus:ring-1 focus:ring-blue-500"}),(0,c.jsx)("button",{onClick:g,disabled:!n,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]}),(0,c.jsx)("div",{className:"mt-4 flex justify-center",children:(0,c.jsx)("button",{onClick:u,disabled:n,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reconnect"})})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=6064)}),_N_E=e.O()}]);